<div class="table-header">
  <p>
    Showing {{ (currentPage() - 1) * pageSize() + 1 }}-{{ lastItemIndex() }} of
    {{ totalItems() }} results
  </p>
  <div class="table-filter">
    <div class="form-group min-width-150">
      <label for="roles">Roles</label>
      <!-- <ng-select
        placeholder="All"
        id="roles"
        clearable="false"
        searchable="false"
        [multiple]="true"
        class="multi-form-select md-multi-select rounded"
      >
      @for (role of roleDropdown(); track role.roleId) {
        <ng-option [value]="role.roleId">{{ role.roleName }}</ng-option>
      }
      </ng-select> -->
      <ng-select
        [items]="roleDropdown() ?? []"
        [(ngModel)]="filters.value()['roleIds']"
        bindLabel="roleName"
        (ngModelChange)="onMultiChange('roleIds', $event)"
        (clear)="onMultiChange('roleIds', [])"
        bindValue="roleId"
        [multiple]="true"
        class="select-dropdown select-dropdown-circle mr-2 w-100"
        placeholder="Select user..."
      >
      </ng-select>
    </div>
    <!-- <div class="form-group min-width-150">
      <label for="department">Department</label>
      <ng-select placeholder="All" id="Department" clearable="false" searchable="false" [multiple]="true"
        class="select-dropdown select-dropdown-circle mr-2 w-100">
        <ng-option value="All">All</ng-option>
        <ng-option value="Cherry Orchard">Cherry Orchard</ng-option>
      </ng-select>
    </div> -->
    <div class="form-group min-width-150 ng-select-md">
      <label for="warehouse">Status</label>
      <ng-select
        class="select-dropdown select-dropdown-circle mr-2 w-100"
        placeholder="All"
        id="status"
        [searchable]="false"
        [items]="statusOptions"
        bindLabel="label"
        bindValue="value"
        [clearable]="true"
        [ngModel]="filters.value()['status']"
        (ngModelChange)="onStatusChange($event)"
      >
      </ng-select>
    </div>
    <!-- <a [routerLink]="'/pages/user-management/users/invite-user'" class="icon-sm-btn bg-primary">
      <span class="icon">
        <svg width="12" viewBox="0 0 18 18" fill="currentColor">
          <use href="assets/sprite.svg#svg-plus"></use>
        </svg>
      </span>
      Invite User
    </a> -->
    <a href="javascript:void(0);" (click)="createUpdateRoleModal()" class="icon-sm-btn bg-primary">
      <span class="icon">
        <svg width="12" viewBox="0 0 18 18" fill="currentColor">
          <use href="assets/sprite.svg#svg-plus"></use>
        </svg>
      </span>
      Create User
    </a>
  </div>
</div>
<!-- <div class="table-responsive"> -->
<table class="table app-table mt-3">
  <thead>
    <tr>
      <!-- <th>
        <label class="custom-checkbox">
          <input type="checkbox" [checked]="allSelected()" (change)="onSelectAll($event)" />
          <span></span>
        </label>
      </th> -->
      <th>Name</th>
      <th>Email</th>
      <th>Phone</th>
      <th>Status</th>
      <th>Roles</th>
      <!-- <th>Department</th> -->
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    @for (user of filterData().items; track $index) {
      <tr>
        <!-- <td>
          <label class="custom-checkbox">
            <input
              type="checkbox"
              [checked]="selectedRows().includes($index)"
              (change)="onSelectRow($event, $index)"
            />
            <span></span>
          </label>
        </td> -->
        <td class="text-nowrap">{{ user.fullName }}</td>
        <td class="text-nowrap">{{ user.email }}</td>
        <td class="text-nowrap">{{ user.phone }}</td>
        <td>
          @if (user.status === enumRStatus.Inactive) {
            <span class="badge badge-secondary">Inactive</span>
          } @else if (user.status === enumRStatus.Pending) {
            <span class="badge badge-warning">Pending</span>
          } @else if (user.status === enumRStatus.Active) {
            <span class="badge badge-success">Active</span>
          }
        </td>
        <td>{{ user.roles }}</td>
        <!-- <td>{{ user.departments }}</td> -->
        <td>
          <div class="dropdown-action" dropdown placement="bottom right">
            <button dropdownToggle type="button" class="active-btn">
              <svg fill="currentColor" width="16" viewBox="0 0 18 18">
                <use href="assets/sprite.svg#svg-cog"></use>
              </svg>
            </button>
            <ul *dropdownMenu class="dropdown-menu dropdown-menu-right">
              <li>
                <button class="dropdown-item" (click)="viewUser(user)">
                  <svg width="14" viewBox="0 0 16 16" fill="currentColor">
                    <use href="assets/sprite.svg#svg-eye-outline"></use>
                  </svg>
                  View
                </button>
              </li>
              <li>
                <button class="dropdown-item" (click)="updateRoleModal(user)">
                  <svg width="11" viewBox="0 0 11 10" fill="currentColor">
                    <use href="assets/sprite.svg#edit-s-icon"></use>
                  </svg>
                  Edit
                </button>
              </li>
              @if (user.status === enumRStatus.Pending) {
                <li>
                  <button class="dropdown-item">
                    <svg width="11" viewBox="0 0 11 11" fill="currentColor">
                      <use href="assets/sprite.svg#svg-re-active"></use>
                    </svg>
                    Resend Invite
                  </button>
                </li>
              }
              <li>
                <button class="dropdown-item">
                  <svg width="12" viewBox="0 0 12 12" fill="currentColor">
                    <use href="assets/sprite.svg#delete-s-icon"></use>
                  </svg>
                  Delete
                </button>
              </li>
            </ul>
          </div>
        </td>
      </tr>
    }
  </tbody>
</table>
<app-pagination
  [total]="totalItems()"
  [page]="currentPage()"
  [pageSize]="pageSize()"
  (pageChange)="setPage($event)"
  (pageSizeChange)="setPageSize($event)"
></app-pagination>
<!-- </div> -->
<!-- @if (selectedRows().length > 0) {
  <div class="d-flex justify-content-end gap-3 mt-3">
    <a href="javascript:void(0);" class="btn btn-outline-danger">Cancel</a>
    <a href="javascript:void(0);" class="btn btn-danger" (click)="removeAlert()">Delete</a>
    <a href="javascript:void(0);" class="btn btn-outline-blue">Deactivate</a>
    <a href="javascript:void(0);" class="btn btn-theme">Activate</a>
  </div>
} -->

<!-- Angular modal (popup) -->
@if (isViewOpen) {
  <div class="custom-modal-backdrop">
    <div class="custom-modal">
      <div class="custom-modal-header">
        <h5>User Details</h5>
        <button class="close-btn" (click)="closeView()">Ã—</button>
      </div>
      @if (selectedUser; as user) {
        <div class="custom-modal-body">
          <p><strong>Full Name:</strong> {{ user.fullName }}</p>
          <p><strong>Email:</strong> {{ user.email }}</p>
          <p><strong>Phone:</strong> {{ user.phone }}</p>
          <p><strong>Roles:</strong> {{ user.roles }}</p>
          <p><strong>Status:</strong> {{ user.status }}</p>
          <p><strong>Departments:</strong> {{ user.departments }}</p>
        </div>
      }
      <div class="custom-modal-footer">
        <button class="btn btn-sm btn-secondary" (click)="closeView()">Close</button>
      </div>
    </div>
  </div>
}
<!-- <div class="app-pagination bottom-fixed px-3">
  <div class="d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-center gap-4">
      <p>Items per page</p>
      <ng-select clearable="false" [searchable]="false" placeholder="10">
        <ng-option selected value="10">10</ng-option>
        <ng-option value="20">20</ng-option>
        <ng-option value="30">30</ng-option>
        <ng-option value="40">40</ng-option>
        <ng-option value="50">50</ng-option>
      </ng-select>
    </div>
    <ul class="nav">
      <li>
        <a href="">
          <svg width="6" viewBox="0 0 6 10" fill="currentColor">
            <use href="assets/sprite.svg#svg-left-arrow-sm"></use>
          </svg>
        </a>
      </li>
      <li>
        <a href="javascript:void(0);">
          <span>1</span>
        </a>
      </li>
      <li>
        <a href="javascript:void(0);" class="active">
          <span>2</span>
        </a>
      </li>
      <li>
        <a href="javascript:void(0);">
          <span>3</span>
        </a>
      </li>
      <li>
        <a href="javascript:void(0);">
          <span>4</span>
        </a>
      </li>
      <li>
        <a href="javascript:void(0);">
          <span>5</span>
        </a>
      </li>
      <li>
        <a href="javascript:void(0);">
          <svg width="6" viewBox="0 0 6 10" fill="currentColor">
            <use href="assets/sprite.svg#svg-right-arrow-sm"></use>
          </svg>
        </a>
      </li>
    </ul>
  </div>
</div> -->
