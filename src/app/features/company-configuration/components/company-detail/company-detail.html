<div class="company-details card shadow-sm p-3">
  <form [formGroup]="form" (ngSubmit)="submit()" class="app-form">
    <!-- ================== -->
    <!-- Company Detail     -->
    <!-- ================== -->
    <div class="row">
      <div class="form-group col-lg-12">
        <h5>Company Detail</h5>
      </div>
      <div
        class="form-group col-lg-6"
        [class.form-error]="
          form.controls['name'].invalid &&
          (form.controls['name'].dirty || form.controls['name'].touched)
        "
      >
        <div class="position-relative">
          <label class="input-label" for="companyName"> Company Name </label>
          <input
            type="text"
            class="form-control"
            formControlName="name"
            name="companyName"
            placeholder="Company Name"
          />
        </div>
      </div>

      <div
        class="form-group col-lg-6"
        [class.form-error]="
          form.controls['shortName'].invalid &&
          (form.controls['shortName'].dirty || form.controls['shortName'].touched)
        "
      >
        <div class="position-relative">
          <label class="input-label" for="shortName"> Short Name </label>
          <input
            type="text"
            class="form-control"
            formControlName="shortName"
            name="shortName"
            placeholder="Short Name"
          />
        </div>
      </div>

      <div
        class="form-group col-lg-6"
        [class.form-error]="
          form.controls['description'].invalid &&
          (form.controls['description'].dirty || form.controls['description'].touched)
        "
      >
        <div class="position-relative">
          <label class="input-label" for="description"> Description </label>
          <input
            type="text"
            class="form-control"
            formControlName="description"
            name="description"
            placeholder="Description"
          />
        </div>
      </div>

      <div
        class="form-group col-lg-6"
        [class.form-error]="
          form.controls['prefixTicket'].invalid &&
          (form.controls['prefixTicket'].dirty || form.controls['prefixTicket'].touched)
        "
      >
        <div class="position-relative">
          <label class="input-label" for="prefixTicket"> Prefix Ticket </label>
          <input
            type="text"
            class="form-control"
            formControlName="prefixTicket"
            name="prefixTicket"
            placeholder="Prefix Ticket"
          />
        </div>
      </div>
    </div>

    <!-- ================== -->
    <!-- Authentication     -->
    <!-- ================== -->
    <div class="row">
      <div class="form-group col-lg-12">
        <h5 class="">Authentication</h5>
      </div>
      <div
        class="form-group col-md-6"
        [class.form-error]="
          form.controls['accessKey'].invalid &&
          (form.controls['accessKey'].dirty || form.controls['accessKey'].touched)
        "
      >
        <div class="position-relative">
          <label class="input-label" for="accessKey"> Access Key </label>
          <input
            type="text"
            class="form-control"
            formControlName="accessKey"
            name="accessKey"
            placeholder="Access Key"
            readonly
          />
        </div>
      </div>

      <div
        class="form-group col-md-6"
        [class.form-error]="
          form.controls['secretKey'].invalid &&
          (form.controls['secretKey'].dirty || form.controls['secretKey'].touched)
        "
      >
        <div class="position-relative">
          <label class="input-label" for="secretKey"> Secret Key </label>
          <input
            type="password"
            class="form-control"
            formControlName="secretKey"
            name="secretKey"
            placeholder="Secret Key"
            readonly
          />
        </div>
      </div>
    </div>

    <div class="text-end">
      <button type="submit" class="ch-btn ch-btn-green" [disabled]="form.invalid">
        Save Changes
      </button>
    </div>
  </form>
</div>
@if ((company?.defineDataSources?.length ?? 0) > 0) {
  <div class="data-source card shadow-sm p-3 mt-4">
    <h5 class="mb-3" style="font-weight: 600">Data Sources</h5>
    <table class="app-table rounded-border">
      <thead class="fixed-thead">
        <tr>
          <th style="width: 10%">Type</th>
          <th style="width: 60%">Source</th>
          <th style="width: 30%" class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        @for (source of company?.defineDataSources ?? []; track source.id) {
          <tr>
            <td>{{ source.type | enumToString: enumDataSource }}</td>
            <td>{{ source.source }}</td>
            <td class="text-center">
              <button type="button" class="ch-icon-btn me-2" (click)="downloadJson(source)">
                <span class="icon">
                  <svg width="11" viewBox="0 0 11 12" fill="currentColor">
                    <use xlink:href="assets/sprite.svg#download-icon"></use>
                  </svg>
                </span>
                Download JSON
              </button>
              <button type="button" class="ch-icon-btn" (click)="syncSource(source)">
                <span class="icon"
                  ><svg width="12" viewBox="0 0 13 16" fill="currentColor">
                    <use xlink:href="assets/sprite.svg#svg-refresh-double"></use></svg
                ></span>
                Sync
              </button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
} @else {
  <p class="text-muted">No Data Sources available.</p>
}

<app-root-resolution></app-root-resolution>
